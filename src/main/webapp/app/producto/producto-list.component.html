<div class="d-flex flex-wrap mb-2 gap-2">
    <h1 class="mb-0" i18n="@@producto.list.headline">Lista de piezas</h1>
</div>

    <div class="d-flex mb-2 actions-bar"
         [class.no-extra]="!isFilterVisible && !modeloAeronaveId">

        <div class="filter-controls">
            <div class="icon-action">
                <button
                    mat-icon-button
                    class="filter-btn"
                    id="btnFilter"
                    aria-labelledby="btnFilter labelFilter"
                    (click)="toggleFilter()">
                    <mat-icon svgIcon="filter_alt"></mat-icon>
                </button>
                <span id="labelFilter" class="action-text">Filtrar por modelo de aeronave</span>
            </div>

            <div *ngIf="isFilterVisible" @fadeSlide class="filter-inline">
                <div class="select-shell">
                    <mat-select
                        class="filter-select"
                        [(ngModel)]="modeloAeronaveId"
                        (selectionChange)="onFilterChange(modeloAeronaveId)"
                        placeholder="Selecciona un modelo"
                        [panelClass]="'custom-panel'">
                        <mat-option [value]="undefined">Todos los modelos</mat-option>
                        <mat-option *ngFor="let modelo of modelosAeronave" [value]="modelo.mreId">
                            {{ modelo.mreNombre }}
                        </mat-option>
                    </mat-select>
                </div>
            </div>
        </div>

        <div class="icon-action pdf-action"
             [class.is-disabled]="!modeloAeronaveId"
             [class.hide-keep-space]="!modeloAeronaveId">
            <button
                mat-icon-button
                color="primary"
                class="pdf-btn"
                id="btnPdf"
                aria-labelledby="btnPdf labelPdf"
                [disabled]="!modeloAeronaveId"
                [attr.aria-hidden]="!modeloAeronaveId ? 'true' : null"
                [attr.tabindex]="!modeloAeronaveId ? -1 : 0"
                (click)="generarReporte()">
                <mat-icon svgIcon="assignment"></mat-icon>
            </button>
            <span id="labelPdf" class="action-text">Generar reporte</span>
        </div>

        <div class="icon-action add-action">
            <button
                mat-icon-button
                class="add-piece-btn"
                id="btnAdd"
                aria-labelledby="btnAdd labelAdd"
                [routerLink]="['/productos/add']">
                <mat-icon svgIcon="add_box"></mat-icon>
            </button>
            <span id="labelAdd" class="action-text">Añadir pieza</span>
        </div>
    </div>


<div *ngIf="!productos || productos.length === 0" i18n="@@producto.list.empty">No se encontraron productos.</div>

<div *ngIf="productos && productos.length > 0"
     class="table-responsive table-scroll"
     role="region"
     aria-label="Lista de piezas"
     tabindex="0">

    <table
        class="table table-striped align-middle table-pale ">
        <thead>
        <tr>
            <th scope="col" i18n="@@producto.proNumeroParte.label">Número de parte</th>
            <th scope="col" i18n="@@producto.proNombre.label">Nombre</th>
            <th scope="col" i18n="@@producto.proNumeroParteAlterno.label">Número alterno</th>
            <th scope="col" i18n="@@producto.proNumeroSerie.label">Número de serie</th>
            <th scope="col" i18n="@@producto.proUnidades.label">Unidades</th>
            <th scope="col" i18n="@@producto.proTpoNombre.label">Tipo de producto</th>
            <th scope="col" i18n="@@producto.modeloAeronaveNombres.label">Modelos de aeronave</th>
            <th scope="col" i18n="@@producto.proPveNombre.label">Proveedor</th>
            <th scope="col" i18n="@@producto.proAmcNombre.label">Almacén</th>
            <th scope="col" i18n="@@producto.list.actions">Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let producto of productos; trackBy: trackByProducto">
            <td>{{ producto.proNumeroParte }}</td>
            <td>{{ producto.proNombre }}</td>
            <td>{{ producto.proNumeroParteAlterno | na }}</td>
            <td>{{ producto.proNumeroSerie }}</td>
            <td>{{ producto.proUnidades }}</td>
            <td>{{ producto.proTpoNombre }}</td>
            <td>
                <ul class="mb-0">
                    <li *ngFor="let nombre of producto.modeloAeronaveNombres">{{ nombre }}</li>
                </ul>
            </td>
            <td>{{ producto.proPveNombre }}</td>
            <td>{{ producto.proAmcNombre }}</td>
            <td>
                <div class="float-end text-nowrap">
                    <a [routerLink]="['/productos/edit', producto.proId]"
                       class="btn btn-sm btn-secondary"
                       i18n="@@producto.list.edit">Editar</a>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div class="d-flex justify-content-center mt-3">
    <button class="btn btn-primary me-2" (click)="previousPage()" [disabled]="page === 0" i18n="@@pagination.previous"> Anterior </button>
    <span class="align-self-center span">
            Página {{ page + 1 }} de {{ totalPages }}
        </span>
    <button class="btn btn-primary ms-2" (click)="nextPage()" [disabled]="(page + 1) >= totalPages" i18n="@@pagination.next"> Siguiente </button>
</div>
